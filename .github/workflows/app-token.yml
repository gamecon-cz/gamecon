# https://github.com/marketplace/actions/github-app-token
# Simulates javascript requesting a token from Gamecon.cz GitHub App (see autorebase.yml)

on:
    push:
        branches-ignore:
            - main

    # manual only
    workflow_dispatch:

jobs:
    create-app-token:
        runs-on: ubuntu-latest
        steps:
            -   id: create_token
                uses: tibdex/github-app-token@v2
                with:
                    app_id: 1126674 # https://github.com/settings/apps/gamecon-cz-autorebase

                    # Optional.
                    # github_api_url: https://api.example.com

                    # Optional.
                    # installation_retrieval_mode: id

                    # Optional.
                    # installation_retrieval_payload: 1337

                    # Optional.
                    # Using a YAML multiline string to avoid escaping the JSON quotes.
                    # permissions: >-
                    #   {"pull_requests": "read"}

                    private_key: ${{ secrets.APP_PRIVATE_KEY_FOR_AUTOREBASE }}

                    # Optional.
                    # repositories: >-
                    #   ["actions/toolkit", "github/docs"]

                    # Optional.
                    revoke: false

            -   run: "echo 'The created token is masked: ${{ steps.create_token.outputs.token }}'"
